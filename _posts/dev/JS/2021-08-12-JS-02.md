---
layout: post
title: "2차원 배열, 인덱스 에러 처리"
date: 2021-08-20
author: tiaz
permalink: /JS/2
tags: [JavaScript]
---

<div class="callout">:memo: 
  <div>
    <p>2차원 이상의 배열에서 인덱스의 범위를 벗어나는 경우 에러가 발생한다.</p>
    <p>이러한 에러가 왜 발생하는지 어떻게 처리하면 좋을지 고민해봤다.</p>
  </div>
</div>


## 인데스를 벗어나는 접근
---
- 알고리즘 문제를 풀어보면서 가끔 2차원 배열에서 인덱스를 활용하는 문제가 있다.
- 가장 대표적인 문제가 상하좌우의 인덱스를 이용하여 값을 확인하는 문제들이다.
- 이런 문제에서 테두리에 존재하는 값의 주변 인덱스에 접근 할때 에러가 발생한다.

## 인덱스를 벗어나면?
---
- 인덱스를 벗어나서 에러가 발생하는 상황을 확인 해보자.
- 2차원 배열에서 두가지의 경우를 살펴보자.
- 첫번째는 배열의 `두번째 인덱스값을`{:.y-p} 벗어난 경우 → `a[0][5]`
- 두번째는 배열의 `첫번째 인덱스값을`{:.y-p} 벗어난 경우 → `a[-1][0]`

```js
const arr=[[1, 2, 3, 4, 5], 
           [3, 7, 1, 6, 1],
           [7, 2, 5, 3, 4],
           [4, 3, 6, 4, 1],
           [8, 7, 3, 5, 2]];

arr[0][5]  // undefined
arr[-1][0] // Uncaught TypeError ...
```

## 에러가 발생하는 원인
---
- 위에서 두가지 인덱스를 벗어나는 경우를 확인해봤다.
- 두가지 경우 모두 인덱스를 벗어났지만 결과는 다르게 나온것을 알수 있다.
- 그렇다면 두가지 경우를 JS 는 어떻게 해석하는지 확인 해보자.
 
## 연산자 우선순위
---
- 2차원 배열이 해석되는 순서를 이해하면 JS 가 해당 구문을 어떻게 해석하는지 알 수 있다.
- MDN 에서 확인해보면 `[]` 연산자는 `좌결합성`{:.y-p} 인 것을 확인 할 수 있다.
- 2차원 배열은 `[]` 연산자가 두개 사용됐으며 좌결합성으로 인해 왼쪽에서 부터 연산된다.
- [MDN - 연산자 우선순위](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Operators/Operator_Precedence)


## 두번째 인덱스값이 벗어난 경우 : `a[0][5]`{:.y-p}
---
- 먼저 두번째 인덱스를 벗어난 경우를 해석해보자.
- 2차원 배열은 좌결합성으로 인해 왼쪽부터 `a[0]` 를 먼저 해석한다.
- 이후에 그 결과값을 가지고 다시 `[5]` 연산을 수행한다.
- 즉 `a[0]` 로 첫번째 행인 `[1,2,3,4,5]` 라는 1차원이 배열로 해석된다.
- 이후 이 1차원 배열에서 두번째 인덱스값인 `[5]` 를 연산한다.
- 하지만 `[1,2,3,4,5]` 에서 5라는 인덱스는 존재하지 않으므로 `undefined` 로 해석된다.

```js
arr[0][5]

arr[0] // [1, 2, 3, 4, 5]

[1, 2, 3, 4, 5][5] // undefined
```

## 첫번째 인덱스값이 벗어난 경우 : `a[-1][0]`{:.y-p}
---
- 역시나 왼쪽에서부터 `a[-1]` 부터 해석해 나가면 된다.
- a 라는 2차원 배열에서 -1 이라는 행은 존재하지 않기 때문에 `undefined`
- `undefined` 에서 다시 `[0]` 이라는 해석을 수행하지만 이는 배열의 형태가 아니므로
- 위에서 봤던 `Uncaught TypeError` 에러가 발생하게 된다.

```js
arr[-1][0]

arr[-1] // undefiend

undefined[0] // Uncaught TypeError: Cannot read property '0' of undefined
```

## ?? 연산자를 통한 에러 처리
---
- 인덱스를 벗어나는 경우 에러가 나지 않게 처리해보자.
- 첫번째 인덱스를 연산의 결과 `undefined`{:.y-s} `에서 두번째 인덱스 연산을 하는것`{:.y-p}이 에러의 원인이다.
- 이를 방지하기 위해, 첫번째 인덱스가 `undefined` 인 경우 `??` 연산자로 빈 배열로 대체한다.
- 두번째 인덱스에서 배열의 인덱스를 벗어나도 `undefined` 이므로 에러를 방지 할 수 있다.

```js
(arr[-1] ?? [])[0]

arr[-1] // undefined

(undefiend ?? []) // []

[][0] // undefined
```

## 정리
---
- 2차원 배열에서 인덱스를 벗어나면 에러가 발생하는 경우가 있다.
- 이는 첫번째 인덱스 연산에서 `undefined` 가 된 상태에서
- 두번째 인덱스 연산을 수행하게 되면서 발생하는 에러이다.
- 따라서 첫번째 인덱스의 연산에서 `undefined` 인 경우는 `??` 를 통해서 빈배열로 변환해주면 에러를 방지 할 수 있다.