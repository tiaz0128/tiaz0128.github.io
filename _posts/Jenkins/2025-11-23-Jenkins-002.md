---
layout: post
ins_date: 2025-11-23
upd_date: 2025-11-23
category: "Jenkins"
subject: "Jenkins"
title: "Jenkins: GitHub Hook"
description: "AWS EC2에 Docker로 Jenkins를 설치하고 GitHub Webhook을 연동하여 자동 빌드 환경을 구축하는 과정을 정리합니다​."
subtitle: "Docker로 Jenkins 설치하고 GitHub Hook 연결하기"
author: tiaz0128
permalink: /Jenkins/2
tags: [Jenkins, "ci/cd", Docker, EC2, GitHub]
prev_post: /Jenkins/1
ref-link:
  - type: url
    url: 'https://www.jenkins.io/doc/'
    title: 'Jenkins User Documentation'
  - type: url
    url: 'https://hub.docker.com/r/jenkins/jenkins'
    title: 'Jenkins Docker Hub'
---

## 전체 도식

여기서는 Jenkins를 사용하여 GitHub에 새로운 태그가 push될 때마다 자동으로 빌드와 테스트가 실행되는 CI/CD를 구축해봅시다.

![Jenkins 전체 도식](/assets/img/content/Jenkins/001/002.png){:.img-m}

`> Jenkins CI/CD 전체 도식`{:.img-caption}

1. tag push
2. Github WebHook 연결
3. Jenkins(test & build): DockerHub에 이미지 push
4. Jenkins(deploy): ssh를 이용해서 WebServer에 Docker 명령어 원격 수행

## GitHub Webhook 연동

GitHub에 코드가 push되면 자동으로 Jenkins 빌드가 시작되도록 Webhook을 설정하겠습니다.

### 1. GitHub 플러그인 설치 확인

Jenkins 대시보드에서:

1. `Manage Jenkins`{:.path} 클릭
2. `Plugins`{:.path} 클릭
3. `Available plugins`{:.path} 탭에서 "GitHub Integration" 검색
4. 이미 설치되어 있다면 `Installed plugins`{:.path} 탭에서 확인 가능

![GitHub 플러그인](/assets/img/content/Jenkins/001/005.png)

`> GitHub Integration 플러그인 확인`{:.img-caption}

{% include template/alert.html
  type="tip"
  about="추천 플러그인 설치 시 GitHub 관련 플러그인이 자동으로 설치됩니다."
%}

### 2. GitHub Personal Access Token 생성

Jenkins가 GitHub에 접근하려면 Personal Access Token이 필요합니다.

1. GitHub 프로필에서 `Settings`{:.path} 클릭
2. 좌측 메뉴 하단의 `Developer Settings`{:.path} 클릭
3. `Personal access tokens`{:.path} → `Tokens (classic)`{:.path} 선택
4. `Generate new token`{:.path} → `Generate new token (classic)`{:.path} 클릭

![GitHub Token 생성](/assets/img/content/Jenkins/001/006.png)

`> Personal Access Token 생성`{:.img-caption}

**토큰 권한 설정:**

- Note: 토큰 이름 (예: "Jenkins CI")
- Expiration: 만료 기간 설정
- Select scopes:
  - `repo`: 전체 저장소 접근 권한
  - `admin:repo_hook`: Webhook 관리 권한

![Token 권한 설정](/assets/img/content/Jenkins/001/007.png){:.img-m}

`> 필요한 권한만 선택하여 토큰 생성`{:.img-caption}

**"Generate token"** 버튼을 클릭하여 토큰을 생성합니다.

{% include template/alert.html
  type="warning"
  about="생성된 토큰은 한 번만 표시되므로 안전한 곳에 복사해 두세요!"
%}

### 3. Jenkins에 GitHub 인증 정보 등록

Jenkins에서 GitHub Token을 사용할 수 있도록 등록합니다.

1. Jenkins 대시보드 → `Manage Jenkins`{:.path}
2. `Credentials`{:.path} 클릭
3. `System`{:.path} → `Global credentials (unrestricted)`{:.path}
4. `Add Credentials`{:.path} 클릭

![Credentials 등록](/assets/img/content/Jenkins/001/008.png)

`> Jenkins Credentials 관리`{:.img-caption}

**설정값:**

- Kind: `Secret text`{:.path}
- Scope: `Global`{:.path}
- Secret: GitHub에서 생성한 Personal Access Token
- ID: 고유 식별자 (예: "github-token")
- Description: 설명 (예: "GitHub Personal Access Token")

### 4. Jenkins 프로젝트 생성

새로운 Jenkins Job을 생성합니다.

1. Jenkins 대시보드에서 `New Item`{:.path} 클릭
2. 프로젝트 이름 입력 (예: "my-project")
3. `Freestyle project`{:.path} 선택
4. `OK`{:.path} 클릭

![Jenkins Job 생성](/assets/img/content/Jenkins/001/009.png){:.img-m}

`> Freestyle project 생성`{:.img-caption}

### 5. 프로젝트 설정

#### Source Code Management

- `Git`{:.path} 선택
- Repository URL: GitHub 저장소 URL 입력 (예: `https://github.com/username/repo.git`)
- Credentials: 앞서 등록한 GitHub 인증 정보 선택
- Branch Specifier: 빌드할 브랜치 지정 (예: `*/main`)

![Git 설정](/assets/img/content/Jenkins/001/010.png)

`> Git 저장소 연결`{:.img-caption}

#### Build Triggers

GitHub에서 Webhook 이벤트를 받으면 자동으로 빌드가 실행되도록 설정합니다.

- ✅ `GitHub hook trigger for GITScm polling`{:.path} 체크

![Build Triggers](/assets/img/content/Jenkins/001/011.png){:.img-m}

`> GitHub Webhook 트리거 활성화`{:.img-caption}

#### Build Steps

실제로 실행할 빌드 작업을 정의합니다. 예를 들어 Python 프로젝트의 경우:

- `Add build step`{:.path} → `Execute shell`{:.path} 선택

```bash
#!/bin/bash
echo "Starting build..."
python --version
pip install -r requirements.txt
pytest
echo "Build completed!"
```

설정을 완료한 후 **"Save"** 버튼을 클릭합니다.

### 6. GitHub Webhook 설정

이제 GitHub 저장소에서 Webhook을 설정합니다.

1. GitHub 저장소 페이지에서 `Settings`{:.path} 탭 클릭
2. 좌측 메뉴에서 `Webhooks`{:.path} 클릭
3. `Add webhook`{:.path} 버튼 클릭

![GitHub Webhook](/assets/img/content/Jenkins/001/012.png)

`> Webhook 추가`{:.img-caption}

**Webhook 설정:**

- Payload URL: `http://{JENKINS_IP}:8080/github-webhook/`
  - **반드시 마지막에 `/`를 포함**{:.orange}해야 합니다!
- Content type: `application/json`{:.path}
- Which events would you like to trigger this webhook?
  - `Just the push event`{:.path} 선택 (코드 push 시에만 트리거)
- ✅ Active 체크

**"Add webhook"** 버튼을 클릭하여 생성합니다.

![Webhook 설정 완료](/assets/img/content/Jenkins/001/013.png){:.img-m}

`> Webhook이 성공적으로 등록되면 초록색 체크 표시가 나타납니다`{:.img-caption}

## 자동 빌드 테스트

이제 모든 설정이 완료되었습니다! 실제로 자동 빌드가 작동하는지 확인해봅시다.

### 1. 코드 변경 및 Push

로컬에서 코드를 수정하고 GitHub에 push합니다:

```bash
git add .
git commit -m "Test Jenkins webhook"
git push origin main
```

### 2. Jenkins 빌드 확인

Jenkins 대시보드에서 자동으로 빌드가 시작되는 것을 확인할 수 있습니다.

![빌드 실행](/assets/img/content/Jenkins/001/014.png)

`> GitHub push 후 자동으로 빌드가 시작됩니다`{:.img-caption}

프로젝트 이름을 클릭하면 빌드 히스토리와 로그를 확인할 수 있습니다.

### 3. 빌드 결과 확인

- **초록색**: 빌드 성공 ✅
- **빨간색**: 빌드 실패 ❌
- **노란색**: 불안정한 빌드 ⚠️

![빌드 결과](/assets/img/content/Jenkins/001/015.png){:.img-m}

`> 빌드 성공! 🎉`{:.img-caption}

빌드 번호를 클릭하고 `Console Output`{:.path}을 선택하면 상세한 로그를 확인할 수 있습니다.

## 문제 해결

### Webhook 연결 실패

Webhook에 빨간색 X 표시가 나타난다면:

1. **방화벽 확인**: EC2 보안 그룹에서 8080 포트 인바운드 규칙 확인
2. **URL 확인**: Payload URL 끝에 `/`가 있는지 확인
3. **Jenkins 실행 확인**: Jenkins 컨테이너가 정상 실행 중인지 확인

```bash
docker ps | grep jenkins
```

### 빌드 실패

빌드가 실패하는 경우:

1. `Console Output`{:.path}에서 에러 로그 확인
2. GitHub 인증 정보가 올바른지 확인
3. 빌드 스크립트의 명령어가 정확한지 확인

### 권한 문제

Jenkins 컨테이너 내에서 Docker를 사용해야 하는 경우:

```bash
docker run -d \
  --name jenkins \
  -p 8080:8080 \
  -p 50000:50000 \
  -v jenkins_home:/var/jenkins_home \
  -v /var/run/docker.sock:/var/run/docker.sock \
  jenkins/jenkins:lts
```

Docker 소켓을 마운트하여 호스트의 Docker를 사용할 수 있게 합니다.

## 마무리

이제 **GitHub에 코드를 push하면 자동으로 Jenkins 빌드가 실행되는 CI/CD 환경**{:.orange}이 구축되었습니다!

이를 통해:

- 코드 변경사항이 즉시 테스트됨
- 문제를 조기에 발견할 수 있음
- 수동 빌드 작업 시간 절약
- 팀 전체의 개발 생산성 향상

Jenkins는 이 외에도 다양한 플러그인과 기능을 제공합니다. 필요에 따라 자동 배포, 슬랙 알림, 코드 품질 검사 등을 추가로 구성해보세요!

{% include template/alert.html
  type="tip"
  about="다음 단계로 Jenkins Pipeline을 활용한 더 복잡한 CI/CD 구성을 시도해보세요!"
%}

감사합니다! 😊
